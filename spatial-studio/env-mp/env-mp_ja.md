# Spatial Studioのインストール

## 概要

このラボでは、Oracle Cloud Marketplaceを使用してOracle Spatial Studio (Spatial Studio)をプロビジョニングするプロセスについて説明します。Oracle Cloud Marketplaceは、Oracleとサード・パーティが提供するアプリケーションとサービスを提供します。詳細は[こちら](https://docs.oracle.com/en/cloud/marketplace/marketplace-cloud/index.html)を参照してください。

推定ラボ時間: 30分

### 目標

この演習では、次のことを行います。

*   Oracle Cloud MarketplaceからSpatial Studioをインストールする方法について学習します
*   初期起動時にSpatial Studioリポジトリ・スキーマを設定する方法を学習します

### 前提条件

*   Oracle Free Tier、Always Free、有料またはLiveLabsクラウド・アカウント
*   リポジトリ・スキーマが作成されました(ラボ3)。

## タスク1: マーケットプレイスからのSpatial Studioの選択

1.  左上の**「ナビゲーション・メニュー」**をクリックし、**「マーケットプレイス」**を選択します。

![Oracle Cloud Marketplace](https://oracle-livelabs.github.io/common/images/console/marketplace.png "マーケットプレイス")

2.  Spatial Studioを検索し、Oracle Spatial Studioアプリケーションをクリックします。

![Oracle Cloud MarketplaceでのOracle Spatial Studio](images/env-marketplace-2.png "Oracle Spatial Studio Marketplaceイメージ")

3.  使用手順を確認し、条件に同意して「スタックの起動」をクリックします。

![スタックを起動してOracle Spatial Studioをデプロイします](images/env-marketplace-3.png "スタックの起動")

## タスク2: スタックの作成ウィザード

1.  オプションで、デプロイメント・スタックのカスタム名と説明を入力します。次に、デプロイメントに使用するコンパートメントを選択し、「次」をクリックします

![スタックの作成ウィザード](images/env-marketplace-4.png "ウィザードを使用したスタックの作成")

2.  コンピュート・インスタンスの「可用性ドメイン」および「シェイプ」を選択します。

コンピュート・シェイプの詳細は、[こちら](https://docs.oracle.com/en-us/iaas/Content/Compute/References/computeshapes.htm)を参照してください。アベイラビリティ・ドメインで目的のシェイプの割当て可用性をチェックします。これは、Always Freeシェイプを使用する場合、特に重要です。\*OCIコンソールで、「ガバナンス」→「制限、割当ておよび使用状況」にナビゲートします\*サービスの場合は「コンピュート」を選択し、「スコープ」で「可用性ドメイン」を選択します\*目的のシェイプの可用性を確認する\*使用可能な割当てを特定するには、必要に応じて可用性ドメインの選択を変更します

![Oracle Cloudリソースの制限、割当ておよび使用状況](images/env-marketplace-4-1.png "コンピュート・リソースの制限")

割当てを確認したら、スタックの作成ウィザードで選択します。

![スタック・パラメータの設定](images/env-marketplace-5.png "コンピュート・インスタンスを選択します")

その後、下にスクロールします。

3.  オプションで、HTTPSポートおよびSpatial Studioの管理ユーザー名をデフォルトから変更します。Spatial Studio管理ユーザーの認証には、OCI Vaultシークレットまたはパスワードを使用するオプションがあります。次の図は、パスワードを使用する例を示しています。本番デプロイメントでは、OCI Vaultシークレットを使用することをお薦めします。ネットワーク構成のセクションまで下にスクロールします。

ノート: デフォルトでは、Spatial Studioの管理ユーザー名は**admin**です。これは、データベースに格納されているリポジトリ・スキーマの演習3で作成されたデータベース・ユーザー名(studio\_repo)とは異なるSpatial Studioアプリケーション・ユーザーです。

![ポートやパスワードなど、より多くのパラメータを設定します。](images/env-marketplace-6.png "Spatial Studio拡張構成- Spatial Studio管理ユーザー・パスワード")

4.  ネットワークの場合は、新しいVCNまたは既存のVCNを自動的に作成することもできます。新しいVCNを作成するか、既存のVCNを検索するコンパートメントを選択します。

次の図は、「新規VCNの作成」を使用した例を示しています。既存のVCNを使用するには、ステップ2で前述したのと同じアベイラビリティ・ドメインに存在する必要があります。他の既存のSCNがない場合は、残りのデフォルトをそのまま残すことができます。他の既存のSCNがある場合は、競合を回避するためにCIDR値を更新します。

![ネットワークの構成](images/env-marketplace-7.png "Spatial Studio詳細構成- ネットワーク構成")

「SSH Keys」セクションまでスクロールダウンします。

5.  SSH公開キーをロードすると、管理目的でSpatial Studioのファイル・システムにアクセスできます。このダイアログには、一般的なSSH接続ドキュメントへのリンクがあります。鍵ファイルを参照するか、鍵文字列をコピーしてSSH公開鍵を送信します。ファイルからSSH公開キーをロードすると、次のイメージに示すようにキー・ファイル名が表示されます。「次へ」をクリックします。

![SSHキーの追加](images/env-marketplace-8.png "Spatial Studio拡張構成- 公開SSHキー")

6.  エントリのサマリーを確認します。修正が必要な場合は、「戻る」をクリックします。それ以外の場合は、「作成」をクリックしてデプロイメント・プロセスを開始します。デプロイメントの「ジョブ詳細」ページにリダイレクトされます。

![スタックの作成](images/env-marketplace-9.png "スタック定義の確認およびスタックの作成")

## タスク3: デプロイメント進捗の監視

1.  「ジョブの詳細」ページの下部にある「ログ」セクションに進行状況が表示されます。デプロイメントの設定中に最初にスピナーが表示されます。

![スタック・デプロイメント・ジョブのモニター- Terraform適用](images/env-marketplace-10.png "スタック・デプロイメントの進行状況のモニター")

数分後、ログ情報が表示されます。

![デプロイメント・ジョブに関するログ情報](images/env-marketplace-11.png "スタック・デプロイメント・ログ")

2.  ログ・セクションの下部までスクロール・ダウンします。完了すると、「適用完了!」の後にインスタンスの詳細が表示されます。最後の項目はSpatial Studioの公開URLです。このURLをコピーしてブラウザに貼り付けます。

![デプロイメント・ジョブが正常に完了しました](images/env-marketplace-12.png "デプロイ済スタックの出力変数")

## タスク4: 初回ログイン

1.  Spatial StudioのパブリックURLを初めて開くと、プライバシとセキュリティに関連するブラウザ警告が表示されます。特定の警告は、プラットフォームとブラウザによって異なります。

![Spatial Studio URLを開くときに警告](images/env-marketplace-13.png "ブラウザ接続警告")

これはSpatial Studioの問題ではありません。署名付きHTTPS証明書がないWebサイトにアクセスするのは一般的です。署名付き証明書をロードおよび構成すると、この警告が削除されます。ただし、Jettyで証明書をロードするプロセスは、このワークショップの範囲外です。

リンクをクリックして、Webサイトに進みます。

2.  Spatial Studioの管理ユーザー名(デフォルトはadmin)およびステップ2(スタックの作成ウィザード、項目3)で入力したパスワードを入力します。次に、「Sign In」をクリックします。

![Spatial Studioにログインするためのユーザー名とパスワードを指定します](images/env-marketplace-14.png "Spatial Studioのログイン・ダイアログ")

3.  Spatial Studioインスタンスへの最初のログイン時に、Spatial Studioのメタデータ・リポジトリとして使用するデータベース・スキーマの接続情報の入力を求められます。これはSpatial Studioのすべてのメタデータに使用されるデータベース・スキーマであり、Spatial Studioの管理ユーザーが他のデータを格納するために使用することもできます。演習3で作成したスキーマを使用して、「Oracle Autonomous Database」を選択し、「次へ」をクリックします。

![メタデータ接続タイプの選択](images/env-marketplace-15.png "Spatial Studioメタデータ・リポジトリのタイプを選択します")

4.  Lab 3に保存されたWalletファイルを参照(またはドラッグ・アンド・ドロップ)します。ロード後、ウォレット・ファイル名がSelected Walletとしてリストされます。「OK」をクリックします。

![ウォレットのアップロード](images/env-marketplace-16.png "接続ウォレットのアップロード")

5.  演習2で定義したユーザー名とパスワードおよびサービスを入力します。中規模のサービスレベルは、このワークショップに適しています。「OK」をクリックします。

![メタデータ・リポジトリの接続の詳細を入力します](images/env-marketplace-17.png "接続詳細の入力")

6.  Spatial Studioがスキーマへの初期接続を行い、いくつかのメタデータ表を作成する間、しばらくお待ちください。終了すると、Spatial Studioはスタート・ガイド情報で開きます。

![Spatial Studioホームページ- はじめに](images/env-marketplace-18.png "Spatial Studioのランディング・ページ")

## タスク5: データのロードとマップの作成

Spatial Studioが正しく動作していることを確認するには、小さなデータ・サンプルをロード、準備およびビジュアル化します。データには、名前や住所を含む博物館のリストが含まれています。データをジオコーディングし、インタラクティブ・マップでデータをビジュアル化します。

1.  この検証にはSpatial Studioリポジトリ接続を使用できるため、ここでは接続を作成しません。**「データセットの作成」**のタイルをクリックします。

![ウィザードを起動してデータをアップロードします](images/verify-1.png "データセットの作成")

2.  データ・サンプル・ファイルを[ここ](https://objectstorage.us-ashburn-1.oraclecloud.com/p/VEKec7t0mGwBkJX92Jn0nMptuXIlEpJ5XJA-A6C9PymRgY2LhKbjWqHeB5rVBbaV/n/c4u04/b/livelabsfiles/o/data-management-library-files/sf_area_museums.xlsx)からダウンロードし、便利な場所に保存します。次に、ファイルをファイル・アップロード・タイルにドラッグ・アンド・ドロップします。ファイル・アップロード・タイルをクリックしてファイルに移動することもできます。

![データのアップロードによるデータ・セットの作成](images/verify-2.png "既存のスプレッドシート・データのアップロード")

3.  データ・プレビューで、アップロード接続をSPATIAL\_STUDIOに設定し、POSTAL\_CODEのデータ型をSTRINGに設定します。次に、**「発行」**をクリックします。

![アップロード詳細の指定](images/verify-3.png "アップロード詳細の指定および列設定の確認")

4.  アップロードが完了すると、データセットがリストされ、アクションを実行する必要があることを示す警告アイコンが表示されます。警告アイコンをクリックし、キー列を割り当てるには、**「データセット列に移動」**リンクをクリックします。

![データセットのキー列の設定](images/verify-4.png "データセットの問題を解決- キー列を選択または追加します")

5.  キーとしてNAMEを選択し、**「キーの検証」**をクリックします。

![キーの検証](images/verify-5.png "選択したキーの検証")

キーを検証したら、**「適用」**をクリックします。

6.  警告アイコンを再度クリックし、**「ジオコード・アドレス」**ボタンをクリックしてアドレスをマップ・ビジュアライゼーションの座標位置に変換します。

![ジオコーディング・アドレス](images/verify-7.png "データセットの問題の解決- ジオコード・アドレス")

7.  ADDRESS列およびPOSTAL\_CODE列がジオコーディングで使用するために自動的に検出されたことを確認します。デフォルトを受け入れて**「適用」**をクリックします。

![ジオコーディング・アドレスのマッピング](images/verify-8.png "データセットをジオコーディング参照データにマップ")

ジオコーディングが完了すると、データセット・ページに戻ります。

8.  SF\_AREA\_MUSEUMSデータセットのアクション・メニューをクリックし、**「プロジェクトの作成」**を選択します。

![プロジェクトの作成を開始](images/verify-9.png "データセットの新規プロジェクトの作成")

9.  SF\_AREA\_MUSEUMSデータセットをクリックしてドラッグし、マップ上の任意の場所にドロップします。

![データセットを追加し、マップ・キャンバスにドラッグします](images/verify-10.png "データセットをレイヤーとしてプロジェクトに追加")

SF\_AREA\_MUSEUMSデータセットはマップ・レイヤーとして追加され、マップはデータの領域にパンおよびズームします。

10.  SF\_AREA\_MUSEUMSレイヤーのアクション・メニューをクリックし、**「設定」**を選択します

![データ・レイヤー設定](images/verify-11.png "データ・レイヤーのスタイルなどを定義します。")

11.  選択した色と不透明度を選択して、マップ・レイヤーをスタイル設定します。

![スタイル設定](images/verify-12.png "データ・レイヤーの色と不透明度を選択します")

12.  **「相互作用」**タブをクリックし、**「情報ウィンドウの表示」**を有効にして、すべての列を選択します。次に、マップ内の項目をクリックして、選択した項目のデータ値を含む情報ウィンドウを表示します。

![マップ・インタラクションの設定](images/verify-13.png "マップと対話するための詳細の定義")

これにより、基本的なデータの準備と可視化が正しく機能していることが検証されます。

13。左側のナビゲーション・パネル・ボタンをクリックして、データセット・ページに戻ります。このテストを保持する必要がないため、**「変更の破棄」**オプションを選択します。

![変更の破棄](images/verify-14.png "現在のプロジェクトに対して行った変更の破棄")

14.  検証が完了したら、テスト・データセットおよびデータベース表を削除できます。SF\_AREA\_MUSEUMSのアクション・メニューをクリックし、**「削除」**を選択します

![データセットの削除](images/verify-15.png "データセットの削除")

15.  データベース表を削除するオプションを選択し、**「OK」**をクリックします。

![データベース表を完全に削除する場合に選択します](images/verify-16.png "データセットに関連するデータベース表の削除")

Oracle Spatial Studioがプロビジョニングおよびテストされるようになりました。次の演習では、必要なくなったときにSpatial Studioを分解するステップを示します。

## タスク6: Spatial Studioのアンインストール(不要になった場合)

**Marketplaceデプロイメントを完全に削除する場合は、次に進みます。**

1.  左上の**「ナビゲーション・メニュー」**をクリックし、**「開発者サービス」**に移動して**「スタック」**を選択します。

![すべてのデプロイ済リソースのクリーンアップ](https://oracle-livelabs.github.io/common/images/console/developer-resmgr-stacks.png "Marketplaceデプロイメントの削除")

2.  ステップ2で使用するコンパートメントと名前を選択します。次の例では、sandboxという名前のコンパートメントとOracle Spatial Studioという名前のスタックが使用されました。

![適切なコンパートメントを選択し、削除するスタックを選択します](images/env-marketplace-20.png "スタックの選択")

3.  「Terraformアクション」→「破棄」を選択します。

![Oracle Spatial Studioスタックを介してデプロイされたすべてのリソースを破棄します。](images/env-marketplace-21.png "デプロイ済リソースの破棄")

確認を求められます。これにより、マーケットプレイス・デプロイメントによって作成されたコンピュートおよびネットワーク・アーティファクトが削除されます。

4.  Spatial Studioアプリケーションを削除した後も、リポジトリ・スキーマはそのまま残ります。リポジトリ・スキーマを削除するには、演習3の説明に従って**admin**としてデータベースに接続し、次を実行します。

    <copy>DROP USER studio_repo CASCADE;</copy>
    

## さらに学ぶ

*   [Spatial Studio製品ページ](https://www.oracle.com/database/spatial/#rc30p2)
*   [Spatial Studioの開始](https://www.oracle.com/database/technologies/spatial-studio/get-started.html)

## 確認

*   **著者** - Oracle、データベース製品管理、David Lapp氏
*   **最終更新者/日付** - Database Product Management、David Lapp、2023年3月